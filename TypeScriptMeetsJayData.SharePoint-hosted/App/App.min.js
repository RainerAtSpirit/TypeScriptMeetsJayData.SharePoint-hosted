var MyApp;(function(n){n.user,n.ctx=new n.DataService.Context({name:"oData",oDataServiceHost:"../_vti_bin/listdata.svc"});$(document).on("click","a.viewModal",function(n){n.preventDefault();var t={url:"",title:"List Detail",autoSize:!0,allowMaximize:!0,showClose:!0};t.url=n.currentTarget.href,SP.UI.ModalDialog.showModalDialog(t)});$.ajax("../_api/web/CurrentUser",{type:"GET",headers:{Accept:"application/json;odata=verbose"},contentType:"application/json",success:function(t){n.user=t.d},error:function(){console.log("Error"+arguments)}})})(MyApp||(MyApp={})),function(n){(function(t){t.examples=[],t.examples.push({Title:"Create a new project item",Description:"Entity.context.addEventListener() provides an easy way of logging. \nSimply hook that into SP.UI.Notify.addNotification() to provide SharePoint like notification",Code:function(){var t=new n.ctx.Projects.elementType({Title:"Project one"});n.ctx.Projects.add(t),n.ctx.saveChanges()}}),t.examples.push({Title:" Create a another project item by using an object literal",Description:"This time saveChanges() uses explicit success and error callbacks",Code:function(){n.ctx.Projects.add({Title:"Project two"}),n.ctx.saveChanges({success:function(){console.log("Item created!")},error:function(){console.log("Error: ",arguments[0])}})}}),t.examples.push({Title:" Create a another project item",Description:"saveChanges() provides a promise Interface as well, so we can use .then() and .fail() instead of success and error callbacks. My personal favorite ;-)",Code:function(){n.ctx.Projects.add({Title:"Project three"}),n.ctx.saveChanges().then(function(){console.log("Item created")}).fail(function(){console.log("Error: ",arguments[0])})}}),t.examples.push({Title:"Ever had the need to create more than one project in a single network operation?",Description:"addMany() and object literals are your friends. Watch how that translates into a OData's $batch method that sgoes over the wire.",Code:function(){for(var i=[],t=4,r=14;t<r;t++)i.push(new n.DataService.ProjectsItem({Title:"Project "+t}));$.each(i,function(t,i){n.ctx.Projects.add(i)}),n.ctx.saveChanges().then(function(){console.log("Mulitple items created!"),console.dir(i)}).fail(function(){console.log("Error: ",arguments[0])})}}),t.examples.push({Title:"Run a project through its whole life cyle",Description:"Create, Update, Delete in a hurry! Individual notifications for each event",Code:function(){var t=new n.ctx.Projects.elementType({Title:"Unfortunately I won't be here for very long"});n.ctx.Projects.add(t),n.ctx.saveChanges().then(function(){return console.log("Going to attach"),n.ctx.attach(t),t.Title="Told you... they are already updating me. Guess what comes next?",console.log("Going to save"),n.ctx.saveChanges()}).then(function(){return console.log("Going to remove"),n.ctx.Projects.remove(t),n.ctx.saveChanges()}).then(function(){console.log("project life cycle completed")}).fail(function(){console.log("Error: ",arguments[0])})}}),t.examples.push({Title:"Create a new Time Tracking item",Description:"TimeTracking list has a Lookup field to the project list. Here we a going to create a new TimeTracking item AND a new project in a single call.",Code:function(){n.ctx.TimeTrackingList.add({Title:"Test entry",Date:new Date,DurationHours:4,ProjectTask:new n.ctx.Projects.elementType({Title:"Project with related time entry"}),EmployeeId:n.user.Id}),n.ctx.saveChanges().then(function(){console.log("Way too easy, isn't it?")}).fail(function(){console.log("Error: ",arguments[0])})}})})(n.CRUD||(n.CRUD={}));var t=n.CRUD}(MyApp||(MyApp={})),function(n){(function(t){var i=[];$.each(n.CRUD.examples,function(n,t){i.push('<div id="example'+(n+1)+'" class="panel radius anchorLink">'),i.push("<h4>Example "+(n+1)+": "+t.Title+"<\/h4>"),i.push("<p>"+t.Description+"<\/p>"),i.push('<pre><code data-language="javascript">'+t.Code.toString()+"<\/code><\/pre>"),i.push('<a href="#" class="button" onclick="MyApp.view.logResults('+n+');return false;">Run example '+(n+1)+"<\/a>&nbsp;"),i.push('<a href="../lists/projects?IsDlg=1" class="secondary button viewModal" >View project list<\/a>&nbsp;'),i.push('<a href="../lists/TIme Tracking List?IsDlg=1" class="secondary button viewModal" >View time tracking list<\/a>'),i.push("<\/div>")}),$("<ul/>",{"class":"example-list",html:i.join("")}).appendTo("#dynExamples"),Rainbow.color(),t.logResults=function(t){console.info("Example "+(t+1)),n.CRUD.examples[t].Code()}})(n.view||(n.view={}));var t=n.view}(MyApp||(MyApp={})),function(n){(function(t){t.notifyId,$("#notificationArea").appendTo(".ms-cui-ribbonTopBars"),n.ctx.addEventListener("added",function(){console.log("Event notification: Item added",arguments),t.notifyId=SP.UI.Notify.addNotification("Item added")}),n.ctx.addEventListener("updated",function(){console.log("Event notification: Item updated",arguments),t.notifyId=SP.UI.Notify.addNotification("Item updated")}),n.ctx.addEventListener("deleted",function(){console.log("Event notification: Item deleted",arguments),t.notifyId=SP.UI.Notify.addNotification("Item deleted")})})(n.notification||(n.notification={}));var t=n.notification}(MyApp||(MyApp={}))